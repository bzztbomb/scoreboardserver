var sb_data = {"score_types" : [], "timestamp" : ""};

var sb_data_local =
{"timestamp" : "2014-08-17T20:40:34",
"score_types" : [
{"name": "All Time High Scores","scores": [{ "initials": "DNW", "score": 666666666, "date": "", "altar": "TC", "filename": "scores/DNW_666666666__.gif" },
{ "initials": "DNW", "score": 12300000, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/DNW_12300000.gif" },
{ "initials": "BTR", "score": 6667789, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/BTR_6667789.gif" },
{ "initials": "DNW", "score": 2990099, "date": "2014-08-16T22:01:53.307380", "altar": "tc", "filename": "scores/DNW_2990099_2014-08-16T22:01:53.307380_tc.gif" },
{ "initials": "DNW", "score": 1990099, "date": "2014-08-16T22:01:53.307380", "altar": "tc", "filename": "scores/DNW_1990099_2014-08-16T22:01:53.307380_tc.gif" },
{ "initials": "AAA", "score": 1000666, "date": "2014-08-16T21:11:24.058879", "altar": "OG", "filename": "scores/AAA_1000666_2014-08-16T21:11:24.058879_OG.gif" },
{ "initials": "DNW", "score": 990099, "date": "2014-08-16T21:01:53.307380", "altar": "tc", "filename": "scores/DNW_990099_2014-08-16T21:01:53.307380_tc.gif" },
{ "initials": "KRA", "score": 336800, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/KRA_336800.gif" },
{ "initials": "KRA", "score": 306950, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/KRA_306950.gif" },
{ "initials": "BTR", "score": 289175, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/BTR_289175.gif" },
{ "initials": "BTR", "score": 270925, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/BTR_270925.gif" },
{ "initials": "KRA", "score": 267550, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/KRA_267550.gif" }]}
,{"name": "High Scores in the Last 24 hours","scores": [{ "initials": "DNW", "score": 2990099, "date": "2014-08-16T22:01:53.307380", "altar": "tc", "filename": "scores/DNW_2990099_2014-08-16T22:01:53.307380_tc.gif" },
{ "initials": "DNW", "score": 1990099, "date": "2014-08-16T22:01:53.307380", "altar": "tc", "filename": "scores/DNW_1990099_2014-08-16T22:01:53.307380_tc.gif" },
{ "initials": "AAA", "score": 1000666, "date": "2014-08-16T21:11:24.058879", "altar": "OG", "filename": "scores/AAA_1000666_2014-08-16T21:11:24.058879_OG.gif" },
{ "initials": "DNW", "score": 990099, "date": "2014-08-16T21:01:53.307380", "altar": "tc", "filename": "scores/DNW_990099_2014-08-16T21:01:53.307380_tc.gif" },
{ "initials": "", "score": 124225, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/_124225.gif" },
{ "initials": "", "score": 131825, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/_131825.gif" },
{ "initials": "", "score": 133075, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/_133075.gif" },
{ "initials": "", "score": 13725, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/_13725.gif" },
{ "initials": "", "score": 137825, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/_137825.gif" },
{ "initials": "", "score": 15675, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/_15675.gif" },
{ "initials": "", "score": 160875, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/_160875.gif" },
{ "initials": "", "score": 165400, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/_165400.gif" }]}
,{"name": "Most Recent Players","scores": [{ "initials": "DNW", "score": 2990099, "date": "2014-08-16T22:01:53.307380", "altar": "tc", "filename": "scores/DNW_2990099_2014-08-16T22:01:53.307380_tc.gif" },
{ "initials": "DNW", "score": 1990099, "date": "2014-08-16T22:01:53.307380", "altar": "tc", "filename": "scores/DNW_1990099_2014-08-16T22:01:53.307380_tc.gif" },
{ "initials": "AAA", "score": 1000666, "date": "2014-08-16T21:11:24.058879", "altar": "OG", "filename": "scores/AAA_1000666_2014-08-16T21:11:24.058879_OG.gif" },
{ "initials": "DNW", "score": 990099, "date": "2014-08-16T21:01:53.307380", "altar": "tc", "filename": "scores/DNW_990099_2014-08-16T21:01:53.307380_tc.gif" },
{ "initials": "", "score": 124225, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/_124225.gif" },
{ "initials": "", "score": 131825, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/_131825.gif" },
{ "initials": "", "score": 133075, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/_133075.gif" },
{ "initials": "", "score": 13725, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/_13725.gif" },
{ "initials": "", "score": 137825, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/_137825.gif" },
{ "initials": "", "score": 15675, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/_15675.gif" },
{ "initials": "", "score": 160875, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/_160875.gif" },
{ "initials": "", "score": 165400, "date": "2012-07-23T21:01:53.307380", "altar": "TC", "filename": "scores/_165400.gif" }]}
]
};

var realtime_sb = angular.module('realtime_sb', []);

realtime_sb.controller('sb_control', function($scope, $http, $timeout, $location) {
  if ($location.absUrl().indexOf("file://") == 0) {
    $scope.sb_data = sb_data_local;
  } else {
    $scope.sb_data = sb_data;
    (function tick() {
      $http.get('leaderboard/').success(function(data) {
        if ($scope.sb_data.timestamp != data.timestamp)
          $scope.sb_data = data;
        $timeout(tick, 3000);
      }).error(function(data) {
        $timeout(tick, 3000);
      });
    })();
  }
});
